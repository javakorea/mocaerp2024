<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare"
	xmlns:xf="http://www.w3.org/2002/xforms">

	<head>
		<w2:type>COMPONENT</w2:type>
		<w2:buildDate />
		<w2:MSA />
		<xf:model>
			<w2:dataCollection baseNode="map">
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_HHs" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="CODE" name="CODE" dataType="text"></w2:column>
						<w2:column id="DATA" name="DATA" dataType="text"></w2:column>
					</w2:columnInfo>
					<w2:data use="true">
						<w2:row>
							<CODE><![CDATA[06]]></CODE>
							<DATA><![CDATA[6시(아침)]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[07]]></CODE>
							<DATA><![CDATA[7시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[08]]></CODE>
							<DATA><![CDATA[8시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[09]]></CODE>
							<DATA><![CDATA[9시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[10]]></CODE>
							<DATA><![CDATA[10시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[11]]></CODE>
							<DATA><![CDATA[11시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[12]]></CODE>
							<DATA><![CDATA[12시(점심)]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[13]]></CODE>
							<DATA><![CDATA[13시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[14]]></CODE>
							<DATA><![CDATA[14시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[15]]></CODE>
							<DATA><![CDATA[15시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[16]]></CODE>
							<DATA><![CDATA[16시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[17]]></CODE>
							<DATA><![CDATA[17시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[18]]></CODE>
							<DATA><![CDATA[18시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[19]]></CODE>
							<DATA><![CDATA[19시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[20]]></CODE>
							<DATA><![CDATA[20시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[21]]></CODE>
							<DATA><![CDATA[21시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[22]]></CODE>
							<DATA><![CDATA[22시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[23]]></CODE>
							<DATA><![CDATA[23시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[00]]></CODE>
							<DATA><![CDATA[0시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[01]]></CODE>
							<DATA><![CDATA[1시(새벽)]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[02]]></CODE>
							<DATA><![CDATA[2시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[03]]></CODE>
							<DATA><![CDATA[3시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[04]]></CODE>
							<DATA><![CDATA[4시]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[05]]></CODE>
							<DATA><![CDATA[5시]]></DATA>
						</w2:row>						
					</w2:data>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_MIs" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="CODE" name="CODE" dataType="text"></w2:column>
						<w2:column id="DATA" name="DATA" dataType="text"></w2:column>
					</w2:columnInfo>
					<w2:data use="true">
						<w2:row>
							<CODE><![CDATA[00]]></CODE>
							<DATA><![CDATA[00분]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[10]]></CODE>
							<DATA><![CDATA[10분]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[20]]></CODE>
							<DATA><![CDATA[20분]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[30]]></CODE>
							<DATA><![CDATA[30분]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[40]]></CODE>
							<DATA><![CDATA[40분]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[50]]></CODE>
							<DATA><![CDATA[50분]]></DATA>
						</w2:row>
					</w2:data>
				</w2:dataList>			
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_gubunList" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="CODE" name="CODE" dataType="text" length="" />
						<w2:column id="DATA" name="DATA" dataType="text" length="" />
					</w2:columnInfo>
					<w2:data use="true">
						<w2:row>
							<CODE><![CDATA[1]]></CODE>
							<DATA><![CDATA[개인]]></DATA>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[2]]></CODE>
							<DATA><![CDATA[업무]]></DATA>
						</w2:row>
					</w2:data>
				</w2:dataList>			
				<w2:dataList baseNode="list" id="dlt_list" repeatNode="map" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column dataType="text" id="SCH_IDX" name="SCH_IDX" />
						<w2:column dataType="text" id="SCH_CATEGORY" name="SCH_CATEGORY" />
						<w2:column id="SCH_TITLE2" name="SCH_TITLE2" dataType="text"></w2:column>
						<w2:column dataType="text" id="SCH_TITLE" name="SCH_TITLE" />
						<w2:column dataType="text" id="SCH_CONT" name="SCH_CONT" />
						<w2:column dataType="text" id="SCH_WRITER" name="SCH_WRITER" />
						<w2:column id="SCH_CREATE_DTTM" name="SCH_CREATE_DTTM" dataType="text"></w2:column>
						<w2:column id="SCH_CURRENTMONTH" name="SCH_CURRENTMONTH" dataType="text"></w2:column>
						
						<w2:column id="SCH_START" 			name="SCH_START" 		dataType="text"></w2:column>
						<w2:column id="SCH_END" 			name="SCH_END" 			dataType="text"></w2:column>
						<w2:column id="SCH_START_TIME" 		name="SCH_START_TIME" 	dataType="text"></w2:column>
						<w2:column id="SCH_END_TIME" 		name="SCH_END_TIME" 	dataType="text"></w2:column>

						<w2:column id="SCH_COLOR" name="SCH_COLOR" dataType="text"></w2:column>
						<w2:column id="FUL_COLOR" name="FUL_COLOR" dataType="text" importFormatter="scwin.fn_format"></w2:column>

						<w2:column id="SCH_DELYN" name="SCH_DELYN" dataType="text"></w2:column>
						<w2:column id="SCH_SENDYN" name="SCH_SENDYN" dataType="text"></w2:column>
						<w2:column id="SCH_SUCCESSYN" name="SCH_SUCCESSYN" dataType="text"></w2:column>
						<w2:column id="SCH_ICO" name="SCH_ICO" dataType="text"></w2:column>
					</w2:columnInfo>
					<w2:data use="false"></w2:data>
				</w2:dataList>
				<w2:dataList baseNode="list" id="dlt_detail" repeatNode="map" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="SCH_IDX" 		name="SCH_IDX" 		dataType="text" />
						<w2:column id="SCH_WRITER" 		name="SCH_WRITER" 	dataType="text" />
						<w2:column id="SCH_START" 		name="SCH_START" 	dataType="text" />
						<w2:column id="GRP_NM" 			name="SCH_WRITER" 	dataType="text" />
					</w2:columnInfo>
					<w2:data use="false"></w2:data>
				</w2:dataList>				
				

				
				<w2:dataMap baseNode="map" id="dma_search">
					<w2:keyInfo>
						<w2:key id="SCH_CURRENTMONTH_PREV" name="SCH_CURRENTMONTH_PREV" dataType="text"></w2:key>
						<w2:key id="SCH_CURRENTMONTH" name="SCH_CURRENTMONTH" dataType="text"></w2:key>
						<w2:key id="SCH_CURRENTMONTH_NEXT" name="SCH_CURRENTMONTH_NEXT" dataType="text"></w2:key>
						<w2:key id="SCH_WRITER" name="SCH_WRITER" dataType="text"></w2:key>
						
						<!-- 공통부 -->
						<w2:key id="COMMON_TRAN_ID" 			name="TRAN_ID" 						dataType="text"></w2:key>
						<w2:key id="COMMON_STATUS" 				name="CRUD_상태" 						dataType="text"></w2:key>
						<w2:key id="COMMON_QUERY" 				name="SELECT_QUERY" 				dataType="text"></w2:key>
						<w2:key id="COMMON_MASTER_QUERY" 		name="COMMON_MASTER_QUERY" 			dataType="text"></w2:key>
						<w2:key id="COMMON_MASTER_DELETEQUERY" 	name="COMMON_MASTER_DELETEQUERY" 	dataType="text"></w2:key>
						<w2:key id="COMMON_DETAIL_INSERTQUERY" 	name="SUBQUERY" 					dataType="text"></w2:key>
						<w2:key id="COMMON_DETAIL_UPDATEQUERY" 	name="SUBQUERY" 					dataType="text"></w2:key>
						<w2:key id="COMMON_DETAIL_DELETEQUERY" 	name="SUBQUERY" 					dataType="text"></w2:key>
						<w2:key id="COMMON_MASTER_KEY" 			name="COMMON_MASTER_KEY" 			dataType="text"></w2:key>
						<w2:key id="COMMON_DETAIL_KEY" 			name="COMMON_DETAIL_KEY" 			dataType="text"></w2:key>		
						<w2:key id="COMMON_DETAIL_BEFORE_INSERTQUERY" 			name="COMMON_DETAIL_BEFORE_INSERTQUERY" 			dataType="text"></w2:key>					
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_content">
					<w2:keyInfo>
						<w2:key id="SCH_IDX" name="SCH_IDX" dataType="text"></w2:key>
						<w2:key id="SCH_TITLE" name="SCH_TITLE" dataType="text"></w2:key>
						<w2:key id="SCH_CONT" name="SCH_CONT" dataType="text"></w2:key>
						<w2:key id="SCH_WRITER" name="SCH_WRITER" dataType="text"></w2:key>

						<w2:key id="SCH_CREATE_DTTM" name="SCH_CREATE_DTTM" dataType="text"></w2:key>
						<w2:key id="SCH_CURRENTMONTH" name="SCH_CURRENTMONTH" dataType="text"></w2:key>
						
						<w2:key id="SCH_START" name="SCH_START" dataType="text"></w2:key>
						<w2:key id="SCH_START_TIME" 		name="SCH_START_TIME" 	dataType="text"></w2:key>
						<w2:key id="SCH_END" name="SCH_END" dataType="text"></w2:key>
						<w2:key id="SCH_END_TIME" 		name="SCH_END_TIME" 	dataType="text"></w2:key>
						
						<w2:key id="SCH_COLOR" name="SCH_COLOR" dataType="text"></w2:key>
						<w2:key id="SCH_DELYN" name="SCH_DELYN" dataType="text"></w2:key>
						<w2:key id="SCH_SENDYN" name="SCH_SENDYN" dataType="text"></w2:key>
						<w2:key id="STATUS" name="STATUS" dataType="text"></w2:key>
						<w2:key id="SCH_SUCCESSYN" name="SCH_SUCCESSYN" dataType="text"></w2:key>
						<w2:key id="SCH_ICO" name="SCH_ICO" dataType="text"></w2:key>
						
						<w2:key id="TYPE" name="LINK" dataType="text"></w2:key>

						<!-- 공통부 -->
						<w2:key id="COMMON_STATUS" name="CRUD_상태" dataType="text"></w2:key>
						<w2:key id="COMMON_QUERY" name="SELECT_QUERY" dataType="text"></w2:key>
						<w2:key id="COMMON_MASTER_QUERY" name="COMMON_MASTER_QUERY" dataType="text"></w2:key>
						<w2:key id="COMMON_DETAIL_INSERTQUERY" name="SUBQUERY" dataType="text"></w2:key>
						<w2:key id="COMMON_DETAIL_UPDATEQUERY" name="SUBQUERY" dataType="text"></w2:key>
						<w2:key id="COMMON_DETAIL_DELETEQUERY" name="SUBQUERY" dataType="text"></w2:key>
						<w2:key id="COMMON_MASTER_KEY" name="COMMON_MASTER_KEY" dataType="text"></w2:key>
						<w2:key id="COMMON_DETAIL_KEY" name="COMMON_DETAIL_KEY" dataType="text"></w2:key>
						<w2:key id="COMMON_DETAIL_BEFORE_INSERTQUERY" name="COMMON_DETAIL_BEFORE_INSERTQUERY" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>		
				<w2:dataMap baseNode="map" id="COMMON_RESULT">
					<w2:keyInfo>
						<w2:key id="COMMON_MASTER_RESULT" name="COMMON_MASTER_RESULT" dataType="text"></w2:key>
						<w2:key id="COMMON_DETAIL_RESULT" name="COMMON_DETAIL_RESULT" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>						
			</w2:dataCollection>
			<w2:workflowCollection></w2:workflowCollection>
			<xf:submission 
				id="sbm_schdList" ref="data:json,dma_search" target="data:json,dlt_list" 
				action="/selectList.do" ev:submitdone="scwin.sbm_schdList_submitdone"
				method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
				processMsg="" ev:submit="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sbm_commonTran" ref='data:json,[{"id":"dma_content","key":"dma_common_request"}]'
				target="data:json,COMMON_RESULT" action="/commonTran.do" method="post" mediatype="application/json" encoding="UTF-8" instance=""
				replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit=""
				ev:submitdone="scwin.sbm_commonTran_submitdone" ev:submiterror="" abortTrigger="">
			</xf:submission>			

			<xf:submission id="sbm_commonTranDetail" ref='data:json,[{"id":"dma_content","key":"dma_common_request"},{"id":"dlt_detail","key":"dlt_common"}]' target="data:json,COMMON_RESULT"
				action="/commonTran.do" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
				customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="scwin.sbm_commonTran_submitdone" ev:submiterror=""
				abortTrigger="">
			</xf:submission>			
		</xf:model>

		<w2:layoutInfo>
		</w2:layoutInfo>

		<w2:publicInfo method="" />
		<script lazy="false" type="text/javascript"><![CDATA[scwin.selectedCell = null;
scwin.selectedSchObj = null;

scwin.linkIcon = '';
scwin.yyyyMmColor = '#dc5773';
scwin.cellBgColor = '#deecee';
scwin.left = null;
scwin.center = null;
scwin.right = null;
scwin.yoil = {일요일:0,월요일:1,화요일:2,수요일:3,목요일:4,금요일:5,토요일:6};
scwin.dayMap = {};

/* 구분컬러CSS로가져오기API */
scwin.getBgColorTag = function(_gubun,o){
	if(o && o.TYPE == 'LINK'){
		let c = scwin.getColor(101);
		return `background-color:${c.backColor};color:${c.color}`;
	}else{
		let c = scwin.getColor(_gubun);
		return `background-color:${c.backColor};color:${c.color}`;
	}
};
/* 구분컬러가져오기API */
scwin.getColor = function(_gubun){
	if(_gubun == 1){
		return {backColor:'#576DDC',color:'white'};
	}else if(_gubun == 101){
		return {backColor:'white',color:'black'};
	}else{
		return {backColor:'#53A786',color:'white'};
	}
};

scwin.onpageload = function() {
	dma_search.set("SCH_WRITER",JSON.parse(sessionStorage.getItem('loginInfo')).id);
	let thisMonth = WebSquare.date.getCurrentServerDate('yyyyMM');
	SCH_CURRENTMONTH.setValue(thisMonth);

	scwin.left = wfm_cal_prev;
	scwin.center = wfm_cal;
	scwin.right = wfm_cal_next;	
	gcm.ext.swiper.scriptImport(function(e){
		scwin.swiper = new Swiper(".mySwiperNew", {
			slidesPerView: 1,
			loop: true
		});
		scwin.swiper.on('realIndexChange', function (_swiperObj) {
			let selectedCalObj = $p.getComponentById(scwin.swiper.slides[scwin.swiper.activeIndex].id);
			let basisMonth = selectedCalObj.scope.grp_yyyyMM.render.innerText.replace(/년|월/g,'');
			SCH_CURRENTMONTH.setValue(basisMonth);
			if(selectedCalObj.org_id == 'wfm_cal_prev'){
				scwin.left = wfm_cal_next;
				scwin.center = wfm_cal_prev;
				scwin.right = wfm_cal;
			}else if(selectedCalObj.org_id == 'wfm_cal'){
				scwin.left = wfm_cal_prev;
				scwin.center = wfm_cal;
				scwin.right = wfm_cal_next;
			}else if(selectedCalObj.org_id == 'wfm_cal_next'){
				scwin.left = wfm_cal;
				scwin.center = wfm_cal_next;
				scwin.right = wfm_cal_prev;		
			}			
			scwin.search();
		});
		scwin.swiper.slideTo(1,0);//아이폰을위해서 (realIndexChange발생)
	});	
};
/* 달력3장그리기 */
scwin.threeCalDraw = function(){
	var yyyyMM 			= scwin.getSCH_CURRENTMONTH();
	let _today = WebSquare.date.getCurrentServerDate('yyyyMMdd');
	if(yyyyMM == _today.substring(0,6)){
		grp_cal.setStyle('background-image', 'url(/cm/images/f.gif)');
		//grp_cal.setStyle('background-repeat', 'no-repeat');
		SCH_CURRENTMONTH.setStyle('color', scwin.gubun1Color);
	}else{
		grp_cal.setStyle('background-image', '');
		grp_cal.setStyle('background-repeat', '');
		SCH_CURRENTMONTH.setStyle('color', '');
	};

	var yyyyMM_prev 	= WebSquare.date.dateTimeAdd( yyyyMM, -1, "month" );
	var yyyyMM_next 	= WebSquare.date.dateTimeAdd( yyyyMM, 1, "month" );

	scwin.center.scope.grp_yyyyMM.render.innerText = yyyyMM.substring(0,4)+'년'+yyyyMM.substring(4)+'월';
	scwin.left.scope.grp_yyyyMM.render.innerText = yyyyMM_prev.substring(0,4)+'년'+yyyyMM_prev.substring(4)+'월';
	scwin.right.scope.grp_yyyyMM.render.innerText = yyyyMM_next.substring(0,4)+'년'+yyyyMM_next.substring(4)+'월';	

	dma_search.set('SCH_CURRENTMONTH_PREV',yyyyMM_prev);
	dma_search.set('SCH_CURRENTMONTH',yyyyMM);
	dma_search.set('SCH_CURRENTMONTH_NEXT',yyyyMM_next);


	dma_search.set('COMMON_QUERY',"M.SEL_MY_SCH_LIST,M.SEL_CH_SCH_LIST");
	com.sbm.execute(sbm_schdList);
	scwin.addDayMap = function(_key,_valObj){
		let aDayList = scwin.dayMap[_key];
		if(!aDayList){
			aDayList = [];
		}
		aDayList.push(_valObj);
		scwin.dayMap[_key] = aDayList;
	};
	scwin.sbm_schdList_submitdone = function(e) {
		scwin.dayMap = {};

		//나의일정
		scwin.setCalData(e.responseJSON.dlt_list);
		//구독일정 
		scwin.setCalData(e.responseJSON.dlt_list1,'link');

		if(scwin.selectedCell && (scwin.selectedCell.getAttribute('yyyyMMdd').substring(0,6) != yyyyMM)){
			if(scwin.selectedCell){scwin.selectedCell.setStyle('background-color','');scwin.selectedCell=null;}
		};
		scwin.draw(yyyyMM,scwin.center.scope);
		scwin.draw(yyyyMM_prev,scwin.left.scope);
		scwin.draw(yyyyMM_next,scwin.right.scope);
	};
}

scwin.setCalData = function(list,_isLink){
	for(let i=0; i < list.length; i++){
		let c = list[i];
		if(_isLink){
			if(c.SCH_WRITER != JSON.parse(sessionStorage.getItem('loginInfo')).id){
				//구독일정일경우
				c.TYPE = 'LINK';
			}
		}
		scwin.addDayMap(c.SCH_START,c);
		if(c.SCH_END){
			let loopMax = 100;//연속100일제한
			let loopMaxCnt = 1;
			while(true){
				if(loopMaxCnt > loopMax){
					break;
				}else{
					let aDay = WebSquare.date.dateTimeAdd( c.SCH_START, +loopMaxCnt, "day" );
					scwin.addDayMap(aDay,c);
					if((c.SCH_END == aDay) || (Number(c.SCH_END) < Number(aDay))){
						break;
					}						
				}				
				loopMaxCnt++;
			}
		}
	}
}
/* 달력1장그리기 */
scwin.draw = function(yyyyMM,_scope) {
	let _today = WebSquare.date.getCurrentServerDate('yyyyMMdd');

	let startDay = yyyyMM+'01';
	let startWeekDay = scwin.yoil[WebSquare.date.getDay(startDay)];
	var yyyyMM_next = WebSquare.date.dateTimeAdd( yyyyMM, 1, "month" );
	let daysInMon = WebSquare.date.dateDiff(yyyyMM+'01',yyyyMM_next+'01');

	var yyyyMM_prev 	= WebSquare.date.dateTimeAdd( yyyyMM, -1, "month" );
	let daysInMon_prev 	= WebSquare.date.dateDiff(yyyyMM_prev+'01',yyyyMM+'01');
	let isStart = -1;
	let writeDay = 1;
	for(let i=0; i < 6;i++){
		for(let j=0; j < 7; j++){
			let dayDiv = _scope.$p.getComponentById('cell' + i + '' + j);
			let _spa = dayDiv.childControlList[0];
			let _contents = dayDiv.childControlList[1];
			_spa.removeClass("on");
			if(i == 0 && j == startWeekDay){
				isStart = 0;
			}else if(i == 0 && isStart == -1 && j != startWeekDay){
				let reday = daysInMon_prev-((startWeekDay-1)-j);
				_spa.setLabel(reday);					dayDiv.setAttribute('yyyyMMdd',yyyyMM_prev+((reday<10)? '0'+reday:reday)	);
			}
			if(isStart == 0){
				_spa.addClass("on");
				_spa.setLabel(writeDay);				dayDiv.setAttribute('yyyyMMdd',yyyyMM+((writeDay<10)? '0'+writeDay:writeDay)  );
				writeDay++;
				if(writeDay > daysInMon){
					isStart = 1;
					writeDay = 0;
				}
			}else if(isStart == 1){
				writeDay++;
				_spa.setLabel(writeDay);				dayDiv.setAttribute('yyyyMMdd',yyyyMM_next+((writeDay<10)? '0'+writeDay:writeDay));
			}
			if((yyyyMM+_spa.render.innerText) == _today){
				_spa.addClass("today_display");
			}else{
				_spa.removeClass("today_display");
			}
			let o = scwin.dayMap[dayDiv.getAttribute('yyyyMMdd')];
			if(o){
				let str = '';
				for(let i=0; i < o.length; i++){
					let aDaySc = o[i];
					let _bgColor = aDaySc['SCH_COLOR'];
					_bgColor = scwin.getBgColorTag(_bgColor,aDaySc);
					let title_display = '';


					if(aDaySc.SCH_SUCCESSYN == 'Y'){
						title_display = '✔'+aDaySc.SCH_TITLE;
					}else{
						title_display = aDaySc.SCH_TITLE;
					}
					if(aDaySc.TYPE == 'LINK'){
						title_display = scwin.linkIcon+title_display;
					}

					
					if(aDaySc.SCH_ICO){
						str += `<span class='sch_bar ml20' style='${_bgColor}'>`;
						str += `<span class="icon">${aDaySc.SCH_ICO}</span>`;
					}else{
						str += `<span class='sch_bar' style='${_bgColor}'>`;
					}
					str += `<span class="bar_txt">${title_display}</span></span>`;
				}
				_contents.render.innerHTML = str;
			}else{
				_contents.render.innerHTML = "";				
			}
			
		}		
	}
};

















/* 현재월가져오기 */
scwin.getSCH_CURRENTMONTH = function(){
	var yyyyMM = SCH_CURRENTMONTH.getValue();
	if(!yyyyMM.match(/^\d{4}0$/) && (yyyyMM.length == 5 || yyyyMM.length == 6)){
		return yyyyMM;
	}else{
		return WebSquare.date.getCurrentServerDate('yyyyMM');
	}
};
/* 조회이벤트API */
scwin.search = function(){
	scwin.threeCalDraw();
};

/* 날짜CELL클릭이벤트API */
scwin.cell_onclick = function(_thisCell) {
    if(scwin.selectedCell){scwin.selectedCell.setStyle('background-color','');}//이전선택된cell은 배경색지우고
	if(_thisCell){
		_thisCell.setStyle('background-color',scwin.cellBgColor);//지금선택된cell에 배경색을 적용
		scwin.selectedCell = _thisCell;
	}
    scwin.openPopup();
	
};
/* 월직접입력조회하는이벤트API */
scwin.SCH_CURRENTMONTH_onviewchange = function() {
	let newValue = scwin.getSCH_CURRENTMONTH();
	let year = newValue.substring(0,4);
	let month = newValue.substring(4);
	month = (month.length==1? "0":"")+month;
	this.setValue(year+month);
	scwin.search();	
};
/* 팝업리스트열기API */
scwin.openPopup = function() {
	btn_closePopup.setLabel('닫기');
	btn_closePopup.show('');	
	btn_reg.setLabel('등록');
	btn_reg.show();
	btn_success.hide();
	btn_update.hide();
	btn_del.hide();
	wfm_pop.setSrc('/ui/SCH_POP_LST.xml');
	scwin.selectedSchObj = null;
};



















/* 왼쪽버튼클릭 */
scwin.btn_left_onclick = function(e) {
	SCH_CURRENTMONTH.setValue(WebSquare.date.dateTimeAdd( SCH_CURRENTMONTH.getValue(), -1, "month" ));
	scwin.search();	
};
/* 오른버튼클릭 */
scwin.btn_right_onclick = function(e) {
	SCH_CURRENTMONTH.setValue(WebSquare.date.dateTimeAdd( SCH_CURRENTMONTH.getValue(), 1, "month" ));
	scwin.search();	
};
/* 오늘버튼클릭 */
scwin.btn_today_onclick = function() {
	SCH_CURRENTMONTH.setValue(WebSquare.date.getCurrentServerDate('yyyyMM'));
	scwin.search();	
};
/* 메뉴버튼클릭 */

/* 닫기버튼클릭 */
scwin.btn_closePopup_onclick = function() {
	if(btn_closePopup.getLabel() == '이전'){
		scwin.openPopup();
	}else{
		scwin.selectedSchObj = null;
		grp_adayList.hide();
		wfm_pop.setSrc('');
		scwin.threeCalDraw();
	}
};
/* 등록버튼클릭 */
scwin.btn_reg_onclick = function(e) {
	if(btn_reg.getLabel() == "등록"){
		scwin.selectedSchObj = null;//선택된 스케쥴항목은클리어하고시작
		btn_reg.setLabel('저장');
		wfm_pop.setSrc('/ui/SCH_POP_REG.xml');
	}else if(btn_reg.getLabel() == "저장"){
		if(!wfm_pop.scope.edi_1.getValue()){
			com.win.alert('일정내용을 입력해주세요.',function(){wfm_pop.scope.edi_1.focus();});
			return;
		}
		let message = '';
		if(wfm_pop.scope.trigger2.getValue() == '간편등록모드로이동'){
			message = '해당 일정을 등록(상세모드)하시겠습니까?';
			wfm_pop.scope.ipt_startHH.getValue();
			wfm_pop.scope.ipt_startMI.getValue();
			wfm_pop.scope.ipc_end.getValue();
			wfm_pop.scope.ipt_endHH.getValue();
			wfm_pop.scope.ipt_endMI.getValue();
			dma_content.set("SCH_START_TIME", wfm_pop.scope.ipt_startHH.getValue()+wfm_pop.scope.ipt_startMI.getValue());
			dma_content.set("SCH_END", wfm_pop.scope.ipc_end.getValue());
			dma_content.set("SCH_END_TIME", wfm_pop.scope.ipt_endHH.getValue()+wfm_pop.scope.ipt_endMI.getValue());
		}else{
			message = '해당 일정을 등록(간편모드)하시겠습니까?';
			wfm_pop.scope.ipt_startHH.setValue("");
			wfm_pop.scope.ipt_startMI.setValue("");
			wfm_pop.scope.ipc_end.setValue("");
			wfm_pop.scope.ipt_endHH.setValue("");
			wfm_pop.scope.ipt_endMI.setValue("");
			dma_content.set("SCH_START_TIME", wfm_pop.scope.ipt_startHH.getValue()+wfm_pop.scope.ipt_startMI.getValue());
			dma_content.set("SCH_END", wfm_pop.scope.ipc_end.getValue());
			dma_content.set("SCH_END_TIME", wfm_pop.scope.ipt_endHH.getValue()+wfm_pop.scope.ipt_endMI.getValue());
		}		
		com.win.confirm(message, function(e){
			if(e.clickValue){
				/* contents */
				dma_content.set("SCH_ICO",wfm_pop.scope.rdo_ico.getValue());
				dma_content.set("SCH_TITLE",wfm_pop.scope.edi_1.getValue().substring(0,20));
				dma_content.set("SCH_CONT", wfm_pop.scope.edi_1.getValue());
				dma_content.set("SCH_CURRENTMONTH",wfm_pop.scope.ipt_day.getValue().substr(0,6));
				dma_content.set("SCH_COLOR", wfm_pop.scope.rdo_gubunYn.getValue());
				dma_content.set("COMMON_MASTER_QUERY"	, "M.INS_SCHEDULE");
				dma_content.set("COMMON_STATUS"			, "I");

				dma_content.set("COMMON_DETAIL_INSERTQUERY"	, "M.INS_MAPP");
				dma_content.set("COMMON_MASTER_KEY","SCH_WRITER,SCH_START,SCH_IDX");dma_content.set("COMMON_DETAIL_KEY","SCH_WRITER,SCH_START,SCH_IDX");

				/* key1 */dma_content.set("SCH_WRITER"			, JSON.parse(sessionStorage.getItem('loginInfo')).id);
				/* key2 */dma_content.set("SCH_START"			, wfm_pop.scope.ipt_day.getValue());
				wfm_pop.scope.chk_channel.getValue();

				let arr = wfm_pop.scope.chk_channel.getValue().split(',');
				let detail_list = [];
				for(let i=0; i < arr.length; i++){
					let row = {GRP_NM : arr[i]};
					row["SCH_WRITER"] = JSON.parse(sessionStorage.getItem('loginInfo')).id;
					row["SCH_START"] = wfm_pop.scope.ipt_day.getValue();
					detail_list.push(row);
				}
				dlt_detail.setJSON(detail_list);
				for(let i=0; i < arr.length; i++){
					dlt_detail.modifyRowStatus(i,'C'); 
				}

				
				com.sbm.execute(sbm_commonTranDetail);
			}
		});
	}
};
/* 수정버튼클릭 */
scwin.btn_update_onclick = function(e) {
	if(btn_update.getLabel() == "수정"){
		btn_update.setLabel('저장');
		wfm_pop.setSrc('/ui/SCH_POP_REG.xml');
	}else if(btn_update.getLabel() == "저장"){
		if(!wfm_pop.scope.edi_1.getValue()){
			com.win.alert('일정내용을 입력해주세요.',function(){wfm_pop.scope.edi_1.focus();});
			return;
		}
		let message = '';
		if(wfm_pop.scope.trigger2.getValue() == '간편등록모드로이동'){
			message = '해당 일정을 수정(상세모드)하시겠습니까?';
			wfm_pop.scope.ipt_startHH.getValue();
			wfm_pop.scope.ipt_startMI.getValue();
			wfm_pop.scope.ipc_end.getValue();
			wfm_pop.scope.ipt_endHH.getValue();
			wfm_pop.scope.ipt_endMI.getValue();
			dma_content.set("SCH_START_TIME", wfm_pop.scope.ipt_startHH.getValue()+wfm_pop.scope.ipt_startMI.getValue());
			dma_content.set("SCH_END", wfm_pop.scope.ipc_end.getValue());
			dma_content.set("SCH_END_TIME", wfm_pop.scope.ipt_endHH.getValue()+wfm_pop.scope.ipt_endMI.getValue());
		}else{
			message = '해당 일정을 수정(간편모드)하시겠습니까?';
			wfm_pop.scope.ipt_startHH.setValue("");
			wfm_pop.scope.ipt_startMI.setValue("");
			wfm_pop.scope.ipc_end.setValue("");
			wfm_pop.scope.ipt_endHH.setValue("");
			wfm_pop.scope.ipt_endMI.setValue("");
			dma_content.set("SCH_START_TIME", wfm_pop.scope.ipt_startHH.getValue()+wfm_pop.scope.ipt_startMI.getValue());
			dma_content.set("SCH_END", wfm_pop.scope.ipc_end.getValue());
			dma_content.set("SCH_END_TIME", wfm_pop.scope.ipt_endHH.getValue()+wfm_pop.scope.ipt_endMI.getValue());
		}			
		com.win.confirm(message, function(e){
			if(e.clickValue){
				/* contents */
				dma_content.set("SCH_ICO",wfm_pop.scope.rdo_ico.getValue());
				dma_content.set("SCH_TITLE",wfm_pop.scope.edi_1.getValue().substring(0,20));
				dma_content.set("SCH_CONT", wfm_pop.scope.edi_1.getValue());
				dma_content.set("SCH_CURRENTMONTH",scwin.selectedSchObj.SCH_START.substr(0,6));
				dma_content.set("SCH_COLOR", wfm_pop.scope.rdo_gubunYn.getValue());
				dma_content.set("COMMON_MASTER_QUERY"	, "M.UPT_SCHEDULE");
				dma_content.set("COMMON_STATUS"			, "U");
				/* key1 */dma_content.set("SCH_WRITER"			, JSON.parse(sessionStorage.getItem('loginInfo')).id);
				/* key2 */dma_content.set("SCH_START"			, scwin.selectedSchObj.SCH_START);
				/* key3 */dma_content.set("SCH_IDX"				, scwin.selectedSchObj.SCH_IDX);








				/* contents */
				dma_content.set("COMMON_DETAIL_BEFORE_INSERTQUERY"	, "M.DEL_MAPP");
				dma_content.set("COMMON_DETAIL_INSERTQUERY"	, "M.INS_MAPP");
				dma_content.set("COMMON_MASTER_KEY","SCH_WRITER,SCH_START,SCH_IDX");dma_content.set("COMMON_DETAIL_KEY","SCH_WRITER,SCH_START,SCH_IDX");
				wfm_pop.scope.chk_channel.getValue();

				let arr = wfm_pop.scope.chk_channel.getValue().split(',');
				let detail_list = [];
				for(let i=0; i < arr.length; i++){
					let row = {GRP_NM : arr[i]};
					row["SCH_WRITER"] = JSON.parse(sessionStorage.getItem('loginInfo')).id;
					row["SCH_START"] = wfm_pop.scope.ipt_day.getValue();
					detail_list.push(row);
				}
				dlt_detail.setJSON(detail_list);
				for(let i=0; i < arr.length; i++){
					dlt_detail.modifyRowStatus(i,'C'); 
				}

				
				com.sbm.execute(sbm_commonTranDetail);


			}
		});
	}
};
/* 완료버튼클릭 */
scwin.btn_success_onclick = function(e) {
	if(btn_success.getLabel() == '완료취소'){
		com.win.confirm('해당 일정을 \'완료취소\'처리하시겠습니까?', function(e){
			if(e.clickValue){
				dma_content.set("SCH_SUCCESSYN","N");
				dma_content.set("COMMON_MASTER_QUERY"	, "M.UPT_SCHEDULE");
				dma_content.set("COMMON_STATUS"			, "U_SCH_SUCCESSYN_N");
				/* key1 */dma_content.set("SCH_WRITER"			, JSON.parse(sessionStorage.getItem('loginInfo')).id);
				/* key2 */dma_content.set("SCH_START"			, scwin.selectedSchObj.SCH_START);
				/* key3 */dma_content.set("SCH_IDX"				, scwin.selectedSchObj.SCH_IDX);
				com.sbm.execute(sbm_commonTran);
			}
		});
	}else{
		com.win.confirm('해당 일정을 \'완료\'처리하시겠습니까?', function(e){
			if(e.clickValue){
				dma_content.set("SCH_SUCCESSYN","Y");
				dma_content.set("COMMON_MASTER_QUERY"	, "M.UPT_SCHEDULE");
				dma_content.set("COMMON_STATUS"			, "U_SCH_SUCCESSYN");
				/* key1 */dma_content.set("SCH_WRITER"			, JSON.parse(sessionStorage.getItem('loginInfo')).id);
				/* key2 */dma_content.set("SCH_START"			, scwin.selectedSchObj.SCH_START);
				/* key3 */dma_content.set("SCH_IDX"				, scwin.selectedSchObj.SCH_IDX);
				com.sbm.execute(sbm_commonTran);
			}
		});
	}
};
/* 삭제버튼클릭 */
scwin.btn_del_onclick = function(e) {
    com.win.confirm($p, '해당 일정을 삭제하시겠습니까?', function(e){
		if(e.clickValue){
			dma_content.set("SCH_DELYN","Y");
			dma_content.set("COMMON_MASTER_QUERY"	, "M.UPT_SCHEDULE,M.T_DEL_MAPP");
			dma_content.set("COMMON_STATUS"			, "U_SCH_DELYN");
			/* key1 */dma_content.set("SCH_WRITER"			, JSON.parse(sessionStorage.getItem('loginInfo')).id);
			/* key2 */dma_content.set("SCH_START"			, scwin.selectedSchObj.SCH_START);
			/* key3 */dma_content.set("SCH_IDX"				, scwin.selectedSchObj.SCH_IDX);			
			com.sbm.execute(sbm_commonTran);
		}
	});
};

/* sbm_commonTran callback */
scwin.sbm_commonTran_submitdone = function(e) {
	let _j = e.responseJSON;
	if(_j.status == "S"){
		let request = _j.COMMON_RESULT.COMMON_PARAM_MAP;
		
		if(request.COMMON_STATUS == 'U_SCH_SUCCESSYN'){
			com.win.alert('완료처리되었습니다.', function(e){
				btn_closePopup.setLabel('닫기');
				scwin.btn_closePopup_onclick();
			});		
		}else if(request.COMMON_STATUS == 'U_SCH_SUCCESSYN_N'){
			com.win.alert('완료취소되었습니다.', function(e){
				btn_closePopup.setLabel('닫기');
				scwin.btn_closePopup_onclick();
			});		
		}else if(request.COMMON_STATUS == 'U_SCH_DELYN'){
			com.win.alert('삭제되었습니다.', function(e){
				btn_closePopup.setLabel('닫기');
				scwin.btn_closePopup_onclick();
			});		
		}else if(request.COMMON_STATUS == 'I'){
			com.win.alert('등록되었습니다.', function(e){
				btn_closePopup.setLabel('닫기');
				scwin.btn_closePopup_onclick();
			});	
		}else{
			com.win.alert('수정되었습니다.', function(e){
				btn_closePopup.setLabel('닫기');
				scwin.btn_closePopup_onclick();
			});		
		}
	}
};	]]></script>
		<style>
		</style>
	</head>
	<body ev:onpageload="scwin.onpageload">

		<xf:group id="" class="sub_contents flex_gvw flex_m" style="padding:0;">
			<xf:group id="grp_cal" class="sch_wrap" >
				<xf:group id="" class="sch_titleArea">
					<xf:group id="grp_adayList" 
					style="" class="sch_detail_wrap">
						<xf:group id="" class="fl btn_list" style="height:100%">
							<xf:trigger ev:onclick="" style="height:100px;visibility: hidden;" id="" 
							type="button" class="" >
								<xf:label><![CDATA[탑간격강제로줌]]></xf:label>
							</xf:trigger>			
							
							
										
							<xf:trigger style="" id="btn_closePopup" type="button" class="btn_schLeft close" ev:onclick="scwin.btn_closePopup_onclick">
								<xf:label><![CDATA[닫기]]></xf:label>
							</xf:trigger>
							
							<xf:trigger id="btn_reg" style=""  type="button" class="btn_schLeft write" ev:onclick="scwin.btn_reg_onclick">
								<xf:label><![CDATA[등록]]></xf:label>
							</xf:trigger>
							<xf:trigger id="btn_success"  style="display:none;"  type="button" class="btn_schLeft success" ev:onclick="scwin.btn_success_onclick">
								<xf:label><![CDATA[완료]]></xf:label>
							</xf:trigger>
							
							<xf:trigger id="btn_del"  style="display:none;"  type="button" class="btn_schLeft del" ev:onclick="scwin.btn_del_onclick">
								<xf:label><![CDATA[삭제]]></xf:label>
							</xf:trigger>
							<xf:trigger id="btn_update" style="display:none;"  type="button" class="btn_schLeft save" ev:onclick="scwin.btn_update_onclick">
								<xf:label><![CDATA[수정]]></xf:label>
							</xf:trigger>
							<xf:trigger id="btn_deladmin" ev:onclick="scwin.popupAdayListReg" style="display:none;"  type="button" class="btn_schLeft trash" >
								<xf:label><![CDATA[폐기]]></xf:label>
							</xf:trigger>						
						</xf:group>
						<xf:group style="text-align:left;display: block;font-size: 24px;height:100%;" id="grp_list" tagname="div" class="">
							<w2:wframe src="" style="width: 100%;height:100%;" id="wfm_pop" class=""></w2:wframe>
						</xf:group>
					</xf:group>
					<xf:group id="" class="fl">

						<w2:anchor class="btn_toggle menu mo" id="btn_menu" name="" outerDiv="false" style=""
							ev:onclick="com.btn_togglemenu_onclick">
							<xf:label><![CDATA[]]></xf:label>
						</w2:anchor>
						<w2:anchor class="btn_toggle left mo" ev:onclick="scwin.btn_left_onclick" id="btn_left" name="" outerDiv="false"
							style="">
							<xf:label><![CDATA[slide]]></xf:label>
						</w2:anchor>
					</xf:group>
					<xf:group style="" id="grp_yyyyMM" tagname="div" class="sch_tit">
						<xf:input displayFormatter="gcm.display.yyyyPointMM" ev:onviewchange="scwin.SCH_CURRENTMONTH_onviewchange" style=""
							id="SCH_CURRENTMONTH" allowChar="0-9">
						</xf:input>
					</xf:group>
					<xf:group id="" class="fr">
						
						<w2:anchor class="btn_toggle right mo" ev:onclick="scwin.btn_right_onclick" id="btn_right" name="" outerDiv="false"
							style="">
							<xf:label><![CDATA[slide]]></xf:label>
						</w2:anchor>
					<w2:anchor class="btn_toggle today mo mr5" ev:onclick="scwin.btn_today_onclick" id="btn_today" name="" outerDiv="false" style="">
							<xf:label><![CDATA[오늘]]></xf:label>
						</w2:anchor></xf:group>
				</xf:group>
				<xf:group class="swiper mySwiperNew">
					<xf:group style="height:100%;flex-flow:nowrap;" id="" class="calendarbox flex swiper-wrapper">
						<w2:wframe src="SCH_WFM_CAL.xml" style="width: 100%;" id="wfm_cal_prev" class="swiper-slide"></w2:wframe>
						<w2:wframe src="SCH_WFM_CAL.xml" style="width: 100%;" id="wfm_cal" class="swiper-slide"></w2:wframe>
						<w2:wframe src="SCH_WFM_CAL.xml" style="width: 100%;" id="wfm_cal_next" class="swiper-slide"></w2:wframe>
					</xf:group>
				</xf:group>
			</xf:group>
		</xf:group>









		
	</body>
</html>
