<?xml version="1.0" encoding="UTF-8"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare"
	xmlns:xf="http://www.w3.org/2002/xforms">
	<head meta_programId="BM004P01" meta_programName="메뉴별 프로그램 조회 팝업" meta_programDesc="메뉴별 프로그램 조회 팝업" meta_author="Inswave Systems"
		meta_date="2021.02.25">
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:aliasDataMap scope="../dma_content" id="dma_content"></w2:aliasDataMap>
				<w2:aliasDataList scope="../dlt_gubunList" id="dlt_gubunList"></w2:aliasDataList>
			</w2:dataCollection>
			<w2:workflowCollection></w2:workflowCollection>
		</xf:model>
		<w2:layoutInfo></w2:layoutInfo>
		<w2:publicInfo method=""></w2:publicInfo>
		<script type="text/javascript" lazy="false"><![CDATA[scwin.onpageload = function () {
	let _parentDma = $p.parent().scwin.selectedSchObj;
	dma_content.setJSON(_parentDma);
	edi_1.setValue(dma_content.get('SCH_CONT'));

	$p.parent().btn_adayListReg.setLabel('등록');
	$p.parent().btn_adayListReg.hide();
	
	$p.parent().btn_adayListClose.setLabel('이전');
	$p.parent().btn_adayListClose.show('');	

	if(dma_content.get('SCH_SUCCESSYN') == '완료'){
		$p.parent().btn_success.setLabel('완료취소');
	}else{
		$p.parent().btn_success.setLabel('완료');
	} 
	$p.parent().btn_success.show('');

	$p.parent().btn_update.setLabel('수정');
	$p.parent().btn_update.show('');

	$p.parent().btn_del.setLabel('삭제');
	$p.parent().btn_del.show('');
};
/* 일정 논리삭제 */
scwin.btn_del_onclick = function(e) {
    com.win.confirm($p, '해당 게시물을 삭제하시겠습니까?', function(e){
		if(e.clickValue){
			dma_content.set("COMMON_MASTER_QUERY"	, "M.updateSchedule");
			dma_content.set("COMMON_STATUS", "U");dma_content.set("SCH_DELYN","Y");//논리삭제
			com.sbm.execute(sbm_commonTran);
		}
	});
};
/* 일정 물리삭제 */
scwin.btn_adminDel_onclick = function(e) {
	var data = {callbackFn: "scwin.delPop_callback" };
	var options = {
		id: "delPop",
		popupName: "일정삭제",
		modal: true,
		useMaximize : true,
		width: 420, height: 116
	};
	com.win.openPopup("/ui/delPop.xml", options, data);
	scwin.delPop_callback = function(e){
		if(e.delYn){
			com.win.confirm($p, '삭제하시면 데이터를 더이상 복구하실 수 없습니다.\n 해당 게시물을 삭제하시겠습니까?', function(e){
				if(e.clickValue){
					dma_content.set("COMMON_MASTER_QUERY"	, "M.deleteSchedule");
					dma_content.set("COMMON_STATUS", "D");
					com.sbm.execute(sbm_commonTran);
				}
			})
		}
	};	
};

scwin.btn_color_onclick = function(e) {
	var data = {callbackFn: "scwin.colorPop_callback" };
	var options = {
		id: "colorPop",
		className: "fixfix",
		popupName: "색상변경",
		modal: true,
		useMaximize : true,
		width: 420, height: 227
	};
	com.win.openPopup("/ui/colorPop.xml", options, data);
};
scwin.colorPop_callback = function(e){
	if(e.color){
		dma_content.set("SCH_COLOR", e.color);
	}
};

scwin.display = function(_data){
	if(_data){
		let yyyyMMdd = _data.substring(0,10).replace(/-/g,'');
		yyyyMMdd = $p.parent().scwin.getDay(yyyyMMdd);
		return WebSquare.date.getFormattedDate(yyyyMMdd,'yyyy년MM월dd일(EEE)');
	}else{
		return "";
	}
};



scwin.display_color = function(_data){
	let _bgColor = _data;
	_bgColor = $p.parent().scwin.getBgColorTag(_bgColor);
	let j = dlt_gubunList.getMatchedJSON('CODE', _data, true);
	let txt = '';
	if(j && j.length > 0){
		txt = j[0].DATA;
	}
	return `<i style='${_bgColor}'>${txt}</i>`;
};]]></script>
	</head>
	<body ev:onpageload="scwin.onpageload">
		<xf:group id="" class="pop_contents flex_gvw flex_m" style="">

			<xf:group class="tbbox noline mb20 read" id="tbl_search" style="">
				<xf:group adaptive="layout" adaptiveThreshold="768" class="w2tb tb" id="" style="width:100%;" tagname="table">
					<w2:attributes>
						<w2:summary></w2:summary>
					</w2:attributes>
					<xf:group tagname="colgroup">
						<xf:group tagname="col" style=""></xf:group>
					</xf:group>
					<xf:group style="" tagname="tr" id="tr_read">
						<xf:group tagname="td" class="w2tb_td" style="">
							<w2:attributes></w2:attributes>
							
							<w2:textbox class="sch_gubun mr0" displayFormatter="scwin.display_color" ref="data:dma_content.SCH_COLOR" id="rdo_gubunYn" label="" style="" tagname="span">
							</w2:textbox><w2:textbox id="" label="" style="display: none" tagname="span" class="sch_spa_view fa fa-calendar-o"></w2:textbox>
							<w2:textbox class="ipt_day" displayFormatter="scwin.display" ref="data:dma_content.SCH_START" id="ipt_day" label=""
								style="" tagname="span">
							</w2:textbox>
						</xf:group>
					</xf:group>
					<xf:group tagname="tr" id="tr_createDt" style="display:none;">
						<xf:group tagname="td" class="w2tb_td">
							<w2:attributes></w2:attributes>
							<xf:input class="" id="ibx_schdDate" placeholder="" readOnly="true" ref="data:dma_content.SCH_CREATE_DTTM"
								style="width:100%;">
							</xf:input>
						</xf:group>
					</xf:group>
					<xf:group tagname="tr" style="display:none;" id="tr_writer">
						<xf:group tagname="td" class="w2tb_td">
							<w2:attributes></w2:attributes>
							<xf:input class="" id="ibx_schdWriter" placeholder="" readOnly="true" ref="data:dma_content.SCH_WRITER" style="width:100%;">
							</xf:input>
						</xf:group>
					</xf:group>
					<xf:group tagname="tr" style="display:none;" id="tr_title">
						<xf:group tagname="td" class="w2tb_td">
							<w2:attributes></w2:attributes>
							<xf:input class="req" id="ibx_boardTitle" placeholder="" ref="data:dma_content.SCH_TITLE" style="width:100%;"></xf:input>
						</xf:group>
					</xf:group>
				</xf:group>
			</xf:group>
			<xf:group id="" class="edbox sch">
				<xf:group id="" style="" class="edi_btn">

				</xf:group>
				<xf:textarea id="edi_1" class="sch_view_cont read" style="height:100%" ref="data:dma_content.SCH_CONT" escape="false"
					readOnly="true">
				</xf:textarea>
			</xf:group>
		</xf:group>

	</body>
</html>
